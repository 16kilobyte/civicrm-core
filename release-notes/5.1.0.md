# CiviCRM 5.1.0

Released May 2, 2018

- **[Synopsis](#synopsis)**
- **[Features](#features)**
- **[Bugs resolved](#bugs)**
- **[Miscellany](#misc)**
- **[Credits](#credits)**
- **[Feedback](#feedback)**

| *Does this version...?*                                         |         |
|:--------------------------------------------------------------- |:-------:|
| Fix security vulnerabilities?                                   |         |
| Change the database schema?                                     |         |
| Alter the API?                                                  |         |
| Require attention to configuration options?                     |         |
| Fix problems installing or upgrading to a previous version?     |         |
| Introduce features?                                             |         |
| Fix bugs?                                                       |         |

## <a name="features"></a>Features

### Dedupe

- **[CRM-21753](https://issues.civicrm.org/jira/browse/CRM-21753) Support 'criteria' in url on batch merge form ([11666](https://github.com/civicrm/civicrm-core/pull/11666))**

### CiviReport

- **[CRM-21677](https://issues.civicrm.org/jira/browse/CRM-21677) Report improvements ([11814](https://github.com/civicrm/civicrm-core/pull/11814), [11898](https://github.com/civicrm/civicrm-core/pull/11898), [11889](https://github.com/civicrm/civicrm-core/pull/11889), [11880](https://github.com/civicrm/civicrm-core/pull/11880), [11876](https://github.com/civicrm/civicrm-core/pull/11876), [11875](https://github.com/civicrm/civicrm-core/pull/11875), [11867](https://github.com/civicrm/civicrm-core/pull/11867), and [11855](https://github.com/civicrm/civicrm-core/pull/11855))**

### Core CiviCRM

- **[CRM-21434](https://issues.civicrm.org/jira/browse/CRM-21434) Add activities to recent items on view and edit ([11891](https://github.com/civicrm/civicrm-core/pull/11891))**

- **[CRM-21489](https://issues.civicrm.org/jira/browse/CRM-21489) Deadlock retries have been accidentally blocked ([11336](https://github.com/civicrm/civicrm-core/pull/11336) and [197](https://github.com/civicrm/civicrm-packages/pull/197))**

- **[CRM-21784](https://issues.civicrm.org/jira/browse/CRM-21784) View custom data for recurring contributions ([11697](https://github.com/civicrm/civicrm-core/pull/11697))**

- **[CRM-21840](https://issues.civicrm.org/jira/browse/CRM-21840) Show Tool Icon For Radio Button Groups ([11819](https://github.com/civicrm/civicrm-core/pull/11819))**

- **[CRM-20981](https://issues.civicrm.org/jira/browse/CRM-20981) Allow custom base-pages with less `crmApp` boilerplate ([10783](https://github.com/civicrm/civicrm-core/pull/10783))**

- **[CRM-20624](https://issues.civicrm.org/jira/browse/CRM-20624) Expose description field for option values in UI ([10403](https://github.com/civicrm/civicrm-core/pull/10403))**

- **[CRM-21835](https://issues.civicrm.org/jira/browse/CRM-21835) Detailed Logging - Use INNODB if Archive is not available  ([11786](https://github.com/civicrm/civicrm-core/pull/11786))**

- **[CRM-20610](https://issues.civicrm.org/jira/browse/CRM-20610) Replace payment details block with editable payment list on 'Edit Contribution' form ([10776](https://github.com/civicrm/civicrm-core/pull/10776))**

### CiviCRM Profile

- **[CRM-21348](https://issues.civicrm.org/jira/browse/CRM-21348) Don't hide the "edit" link from logged-in users in profile listings in joomla front-end. ([11199](https://github.com/civicrm/civicrm-core/pull/11199))**

### CiviMember

- **[CRM-20811](https://issues.civicrm.org/jira/browse/CRM-20811) CIVICRM-167 Schedule Reminders uses mixed terminology for Active state: Active? versus Send Email ([10602](https://github.com/civicrm/civicrm-core/pull/10602))**

## <a name="bugs"></a>Bugs resolved

### Core CiviCRM

- **Fix regression whereby relationship types option no longer in adv search ([12045](https://github.com/civicrm/civicrm-core/pull/12045))**

- **Flush versionCheck cache when upgrading ([12034](https://github.com/civicrm/civicrm-core/pull/12034))**

- **footer.tpl - Change the URL formula pointing to the release notes ([12008](https://github.com/civicrm/civicrm-core/pull/12008))**

- **core/issues/64 - In custom searches, column headings are being ignored ([12005](https://github.com/civicrm/civicrm-core/pull/12005))**

- **VersionCheck - Get more nuanced messages from latest.civicrm.org ([11991](https://github.com/civicrm/civicrm-core/pull/11991))**

- **(dev/mail/8) Using ACL to restrict mailing recipients leads to fatal error ([11963](https://github.com/civicrm/civicrm-core/pull/11963))**

- **Fix trigger generation for modified_date on custom data ([11984](https://github.com/civicrm/civicrm-core/pull/11984))**

- **Fix failure to render dedupe page ([11976](https://github.com/civicrm/civicrm-core/pull/11976))**

- **5.0 merge to master ([11942](https://github.com/civicrm/civicrm-core/pull/11942))**

- **5.0 to master ([11941](https://github.com/civicrm/civicrm-core/pull/11941))**

- **Fix fatal error when selecting a $0 price option in change fee selection ([11934](https://github.com/civicrm/civicrm-core/pull/11934))**

- **Phone: standardize appearance and translation of extension label ([11930](https://github.com/civicrm/civicrm-core/pull/11930))**

- **Tidy up on_hold handling in holdEmail function. ([11884](https://github.com/civicrm/civicrm-core/pull/11884))**

- **5.0 to master ([11935](https://github.com/civicrm/civicrm-core/pull/11935))**

- **Fix Core/Dev 18# where logging fails if the AUTO INCREMENT column is … ([11865](https://github.com/civicrm/civicrm-core/pull/11865))**

- **5.0 to master ([11933](https://github.com/civicrm/civicrm-core/pull/11933))**

- **5.0 merge to master ([11929](https://github.com/civicrm/civicrm-core/pull/11929))**

- **(NFC) make (includes taxes) translation work ([11927](https://github.com/civicrm/civicrm-core/pull/11927))**

- **Handle eq (equals) operator in the report url ([11885](https://github.com/civicrm/civicrm-core/pull/11885))**

- **5.0 merge to master ([11921](https://github.com/civicrm/civicrm-core/pull/11921))**

- **Extract fetchRelationshipDetails function ([11918](https://github.com/civicrm/civicrm-core/pull/11918))**

- **5.0 ([11915](https://github.com/civicrm/civicrm-core/pull/11915))**

- **NFC Minor comments cleanup on MembershipType ([11909](https://github.com/civicrm/civicrm-core/pull/11909))**

- **[CRM-21791](https://issues.civicrm.org/jira/browse/CRM-21791) Accounting batch closed by default when created in localized civicrm ([11878](https://github.com/civicrm/civicrm-core/pull/11878))**

- **Remove cloning hack from export and add unit tests ([11703](https://github.com/civicrm/civicrm-core/pull/11703))**

- **CRM_Utils_Check - Soften messages for read-only extensionsDir ([11895](https://github.com/civicrm/civicrm-core/pull/11895))**

- **NFC Fix function name typo ([11888](https://github.com/civicrm/civicrm-core/pull/11888))**

- **[NFC] Fix mispelled variable and simplify a couple of other vars ([11886](https://github.com/civicrm/civicrm-core/pull/11886))**

- **Fix report form isTableSelected to treat relative date filters as filters ([11882](https://github.com/civicrm/civicrm-core/pull/11882))**

- **"hold_date" not updated if civimail_multiple_bulk_emails is true + test ([11807](https://github.com/civicrm/civicrm-core/pull/11807))**

- **Tweak layout on contribution view screen to make payments clearer ([11863](https://github.com/civicrm/civicrm-core/pull/11863))**

- **[CRM-21842](https://issues.civicrm.org/jira/browse/CRM-21842) broken link ([11879](https://github.com/civicrm/civicrm-core/pull/11879))**

- **[NFC] remove unused vars ([11874](https://github.com/civicrm/civicrm-core/pull/11874))**

- **CiviUnitTestCase - Extract Api3TestTrait and Api3DocTrait ([11872](https://github.com/civicrm/civicrm-core/pull/11872))**

- **Use try catch when deleting groups (dev/core/issues/22 ) ([11826](https://github.com/civicrm/civicrm-core/pull/11826))**

- **Increment minimum upgradable version ([11864](https://github.com/civicrm/civicrm-core/pull/11864))**

- **Fix template structures ([11869](https://github.com/civicrm/civicrm-core/pull/11869))**

- **[CRM-21277](https://issues.civicrm.org/jira/browse/CRM-21277) CRM_Utils_System_WordPress::validInstallDir spams log with warnings when open_basedir restriction is in effect ([11086](https://github.com/civicrm/civicrm-core/pull/11086))**

- **[CRM-19850](https://issues.civicrm.org/jira/browse/CRM-19850) Add a offline membership without 'record payment' option, later edit the membership and saving with 'record payment' option ([11087](https://github.com/civicrm/civicrm-core/pull/11087))**

- **Add commenting to explain +1/-1 days for membership dates calc ([11825](https://github.com/civicrm/civicrm-core/pull/11825))**

- **core/issues/15 Line item fix with attempt to determine how it is hit ([11816](https://github.com/civicrm/civicrm-core/pull/11816))**

- **[CRM-21682](https://issues.civicrm.org/jira/browse/CRM-21682) Automatic membership renewal fixes ([11824](https://github.com/civicrm/civicrm-core/pull/11824))**

- **Dev/Core 25 Wrap the mailing split_job function in a transaction to e… ([11836](https://github.com/civicrm/civicrm-core/pull/11836))**

- **Fix template structure ([11862](https://github.com/civicrm/civicrm-core/pull/11862))**

- **[CRM-20719](https://issues.civicrm.org/jira/browse/CRM-20719) Show warning on system status page if reply_id for mailing is not set to any default. ([10496](https://github.com/civicrm/civicrm-core/pull/10496))**

- **Consolidate CustomData code into shared tpl ([11857](https://github.com/civicrm/civicrm-core/pull/11857))**

- **Fix ajax error on rendering multi custom data tab when field limit reached ([11856](https://github.com/civicrm/civicrm-core/pull/11856))**

- **[nfc] Add test for thousand separators on import ([11859](https://github.com/civicrm/civicrm-core/pull/11859))**

- **[nfc] Minor test tidy ups ([11860](https://github.com/civicrm/civicrm-core/pull/11860))**

- **[NFC] fix line endings, using windows line endings, change to 'unix ([11858](https://github.com/civicrm/civicrm-core/pull/11858))**

- **merge 5.0 to master ([11852](https://github.com/civicrm/civicrm-core/pull/11852))**

- **Escape custom group title. ([11854](https://github.com/civicrm/civicrm-core/pull/11854))**

- **Meld Address custom field display template with main custom field template ([11844](https://github.com/civicrm/civicrm-core/pull/11844))**

- **Fix template structure ([11851](https://github.com/civicrm/civicrm-core/pull/11851))**

- **NFC reformat whitespace in Email.tpl files ([11842](https://github.com/civicrm/civicrm-core/pull/11842))**

- **[CRM-20790](https://issues.civicrm.org/jira/browse/CRM-20790) CIVICRM-159 - Import Contacts, Current Employer (Employee of field) is not being imported at all ([11843](https://github.com/civicrm/civicrm-core/pull/11843))**

- **Merge rc to master ([11847](https://github.com/civicrm/civicrm-core/pull/11847))**

- **core/issues/26 - On behalf form fails to create new organisation ([11841](https://github.com/civicrm/civicrm-core/pull/11841))**

- **Fix template structure issues ([11839](https://github.com/civicrm/civicrm-core/pull/11839))**

- **Merge from rc to master ([11835](https://github.com/civicrm/civicrm-core/pull/11835))**

- **Version check test: in alphas don't test for site stats not provided for alphas ([11831](https://github.com/civicrm/civicrm-core/pull/11831))**

- **[CRM-21807](https://issues.civicrm.org/jira/browse/CRM-21807) Deleted contacts included by default in Membership and contribution detail report. ([11727](https://github.com/civicrm/civicrm-core/pull/11727))**

- **dev/core/17 Convert interview task to use Pseudoconstants ([11809](https://github.com/civicrm/civicrm-core/pull/11809))**

- **[CRM-21838](https://issues.civicrm.org/jira/browse/CRM-21838) When CRM.alert falls back to standard JS alert it should strip html ([11797](https://github.com/civicrm/civicrm-core/pull/11797))**

- **Fix template in pledge and batch ([11818](https://github.com/civicrm/civicrm-core/pull/11818))**

- **Add activity created_date, modified_date and original_id fields to views ([525](https://github.com/civicrm/civicrm-drupal/pull/525))**

- **Fix style warnings ([526](https://github.com/civicrm/civicrm-drupal/pull/526))**

- **add GitHub PR template and Contributing templates to WP repo ([127](https://github.com/civicrm/civicrm-wordpress/pull/127))**

### CiviContribute

- **[CRM-21763](https://issues.civicrm.org/jira/browse/CRM-21763) Cannot record payment for only cents owed ([11668](https://github.com/civicrm/civicrm-core/pull/11668))**

- **[CRM-21264](https://issues.civicrm.org/jira/browse/CRM-21264) print contribution in tabular format with group by contact not working ([11820](https://github.com/civicrm/civicrm-core/pull/11820))**

### CiviMember

- **[CRM-19920](https://issues.civicrm.org/jira/browse/CRM-19920) Job.process_membership uses too much memory ([11890](https://github.com/civicrm/civicrm-core/pull/11890))**

- **[CRM-19151](https://issues.civicrm.org/jira/browse/CRM-19151) Add / fix the Ability to merge memberships ([11298](https://github.com/civicrm/civicrm-core/pull/11298))**

- **[CRM-21711](https://issues.civicrm.org/jira/browse/CRM-21711) When updating multiple memberships thru a contribution page custom fields are only updated on one ([11586](https://github.com/civicrm/civicrm-core/pull/11586))**

### Joomla Integration

- **[CRM-21203](https://issues.civicrm.org/jira/browse/CRM-21203) cli.php PHP error prevents cron jobs from running ([11609](https://github.com/civicrm/civicrm-core/pull/11609))**

## <a name="misc"></a>Miscellany

## <a name="credits"></a>Credits

This release was developed by the following code authors:

AGH Strategies - Alice Frumin, Andrew Hunt, Eli Lisseck; Agileware - Agileware Team, Alok Patel, Francis Whittle, Justin Freeman; Andrew Thompson; Australian Greens - Seamus Lee; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; CompuCorp - Michael Devery, Mukesh Ram; Coop SymbioTIC - Samuel Vanhove; Davis Media Access - Darrick Servis; Fuzion - Jitendra Purohit; JMA Consulting - Monish Deb; Joinery - Allen Shaw; Kompetenzzentrum Technik-Diversity-Chancengleichheit - Niels Heinemann; Left Join Labs - Sean Madsen; lyyana; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting - Matthew Wire; Naomi Rosenberg; Olivier Tétard; Tadpole Collective - Kevin Cristiano; Wikimedia Foundation - Eileen McNaughton

Most authors also reviewed code for this release; in addition, the following
reviewers contributed their comments:

AGH Strategies - Alice Frumin, Eli Lisseck; Agileware - Agileware Team; andrewperry; Andrew Thompson; Australian Greens - Seamus Lee; benjarlett; British Humanist Association - Andrew West; Chris Burgess; Christian Wach; civicrm-builder; CiviCRM - Tim Otten; CiviDesk - Sunil Pawar, Yashodha Chaku; CompuCorp - Jamie Novick, Michael Devery; Coop SymbioTIC - Mathieu Lutfy, Samuel Vanhove; David Hepper; DevApp - Adam Kwiatkowski; Donald Hirst; Francesc Bassas i Bullich; Fuzion - Jitendra Purohit, Peter Davis; Ginkgo Street Labs - Frank Gómez; JMA Consulting - Joe Murray, Monish Deb; Johan Vervloet; John Kingsnorth; Joinery - Allen Shaw; Kompetenzzentrum Technik-Diversity-Chancengleichheit - Niels Heinemann; Korlon - Stuart Gaston; Left Join Labs - Sean Madsen; Lemniscus - Noah Miller; Lighthouse Design and Consulting - Brian Shaughnessy; Lorenzo Ardizzone; lyyana; Marcello Gribaudo; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting - Matthew Wire; Naomi Rosenberg; National Democratic Institute - Evan Summers; Neil Zampella; Nicol Wistreich; Olivier Tétard; penguintrax; pratik.joshi; Progressive Technology Project - Jamie McClelland; Responsive Development Technologies - Thomas Nilefalk; Richard Edgar; SEN Magazine - Jeremy Nicholls; Skvare - Mark Hanna; small biz; Tadpole Collective - Kevin Cristiano; Wikimedia Foundation - Eileen McNaughton

## <a name="feedback"></a>Feedback

These release notes are edited by Andrew Hunt.  If you'd like to provide
feedback on them, please login to https://chat.civicrm.org/civicrm and contact
`@agh1`.
